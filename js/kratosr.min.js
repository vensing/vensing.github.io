let kr={};window.requestIdleCallback=window.requestIdleCallback||function(e){let t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},(()=>{const e=()=>{$(document).on("click",".xHeading",(function(e){$(this).next().slideToggle(300),$(this).parent(".xControl").hasClass("active")?$(this).parent(".xControl").removeClass("active"):$(this).parent(".xControl").addClass("active"),e.preventDefault()}))},t=()=>{$(document).on("click",".donate",()=>{layer.open({type:1,area:["300px","370px"],title:kr.donateBtn,resize:!1,scrollbar:!1,content:'<div class="donate-box"><div class="meta-pay text-center"><strong>'+kr.scanNotice+'</strong></div><div class="qr-pay text-center"><img class="pay-img" id="alipay_qr" src="'+kr.qr_alipay+'"><img class="pay-img d-none" id="wechat_qr" src="'+kr.qr_wechat+'"></div><div class="choose-pay text-center mt-2"><input id="alipay" type="radio" name="pay-method" checked><label for="alipay" class="pay-button"><img src="/images/alipay.webp"></label><input id="wechatpay" type="radio" name="pay-method"><label for="wechatpay" class="pay-button"><img src="/images/wechat.webp"></label></div></div>'}),$(".choose-pay input[type='radio']").click((function(){const e=$(this).attr("id");"alipay"==e&&($(".qr-pay #alipay_qr").removeClass("d-none"),$(".qr-pay #wechat_qr").addClass("d-none")),"wechatpay"==e&&($(".qr-pay #alipay_qr").addClass("d-none"),$(".qr-pay #wechat_qr").removeClass("d-none"))}))})},n=()=>{void 0!==$.fancybox&&($.fancybox.defaults.hash=!1,$(".kratos-hentry").each((function(e){$(this).find("img").each((function(){if($(this).parent().hasClass("fancybox")||$(this).parent().hasClass("qrcode")||$(this).parent().is("a"))return;const e=this.alt;e&&$(this).after('<span class="caption">'+e+"</span>"),$(this).wrap('<a rel="gallery" href="'+this.src+'" data-fancybox="gallery" data-caption="'+e+'"></a>')}))})),$(".fancybox").fancybox())},a=()=>{$(document).on("click","a[class=toc-link]",(function(){return $("html, body").animate({scrollTop:$(decodeURI($(this).attr("href"))).offset().top-60},500),!1}))};let o;let r="";const s=(e,t=!0)=>{let n;const a=e/1e3,o=Math.floor(a/60/60/24),r=Math.floor(a/60/60-24*o),s=Math.floor(a/60-1440*o-60*r),l=Math.floor(a-86400*o-3600*r-60*s);let i=o.toString(),c=r.toString(),d=s.toString(),m=l.toString();return t?(i&&1===i.length&&(i="0"+i),c&&1===c.length&&(c="0"+c),d&&1===d.length&&(d="0"+d),m&&1===m.length&&(m="0"+m),n=i+" 天"+c+" 小时"+d+" 分"+m+" 秒"):n=o<540?o<60?i+" 天":Math.floor(o/30).toString()+" 个月":Math.floor(o/365).toString()+" 年",n};$.fn.pjax_reload=()=>{(()=>{const e=document.getElementsByClassName("kratos-entry-thumb-new-img"),t=kr.picCDN?"//cdn.jsdelivr.net/gh/Candinya/Kratos-Rebirth@latest/source/":"/";for(let n=0,a=e.length;n<a;n++)$(e[n]).attr("src")||$(e[n]).attr("src",t+`images/thumb/thumb_${Math.floor(20*Math.random()+1)}.webp`)})(),n(),o=`\n\n-------------------------\n${kr.copyrightNotice}\n作者：${document.querySelector("meta[name='author']").getAttribute("content")}\n来源：${document.title}\n链接：${window.location.href}\n`,r=document.title,"undefined"!=typeof MathJax&&MathJax.Hub.Typeset(),(()=>{document.querySelectorAll("figure.highlight").forEach((e,t)=>{e.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0].setAttribute("id","code-"+t),e.innerHTML+=`<button class="copy" data-clipboard-target="#code-${t}">\n                <i class="fa fa-copy"></i>&nbsp;复制\n            </button>`});new ClipboardJS("button.copy").on("success",e=>{const t=e.trigger.innerHTML;e.trigger.innerHTML='<i class="fa fa-check-circle"></i>&nbsp;成功~',setTimeout(()=>{e.trigger.innerHTML=t},3e3),e.clearSelection()})})(),(()=>{const e="undefined"!=typeof window,t=e&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),n=e&&"IntersectionObserver"in window,a=document.querySelector(".post-comments.lazy-load"),o=()=>{window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),window.loadCommentsEventHandler=window.requestIdleCallback(load_comm),load_comm=null};if(e&&!t&&n&&null!==a){const e=new IntersectionObserver(t=>{t[0].isIntersecting&&(o(),e.disconnect())},{threshold:0});e.observe(a)}else"undefined"!=typeof load_comm&&null!==load_comm&&o()})(),(()=>{if(kr.expire_day){const e=document.getElementById("expire-alert");if(e){const t=e.querySelector("time"),n=new Date(parseInt(t.getAttribute("datetime"))),a=Date.now()-n;a>24*kr.expire_day*3600*1e3&&(t.innerText=s(a,!1),e.classList.remove("hidden"))}}})()};const l=()=>{$(this).pjax_reload(),kr.copyrightNotice&&(document.body.oncopy=e=>{const t=window.getSelection().toString();t.length>150&&(e.preventDefault(),e.clipboardData&&e.clipboardData.setData("text/plain",t+o))}),(()=>{if(kr.siteLeaveEvent){let e;const t=$('[rel="icon"]').attr("href");document.addEventListener("visibilitychange",()=>{document.hidden?(document.title=kr.leaveTitle,kr.leaveLogo&&$('[rel="icon"]').attr("href",kr.leaveLogo),clearTimeout(e)):(document.title=kr.returnTitle+" "+r,kr.leaveLogo&&$('[rel="icon"]').attr("href",t),e=setTimeout(()=>{document.title=r,e=0},2e3))})}})(),(()=>{const e=new Date(kr.createTime),t=document.getElementById("span_dt");setInterval(()=>{t.innerText=s(Date.now()-e)},1e3)})(),t()};$(()=>{var t;t=l,fetch("/config/main.json").then(e=>e.json()).then(e=>{kr=e}).then(()=>{t()}),(()=>{const e=()=>{$(window).scrollTop()>200?$(".kr-tool").addClass("scroll-down"):$(".kr-tool").removeClass("scroll-down")};$(".gotop-box").on("click",(function(e){return $("html, body").animate({scrollTop:$("html").offset().top},500),!1})),e(),$(window).scroll(()=>{e()})})(),(()=>{let e=$("#kratos-menu-wrap").clone();e.attr({id:"offcanvas-menu"}),e.filter("> ul").attr({class:"ul-me",id:""}),$("#kratos-page").prepend(e),$(".js-kratos-nav-toggle").on("click",()=>{$(".nav-toggle").hasClass("toon")?($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px")):($(".nav-toggle").addClass("toon"),$("#offcanvas-menu").css("right","0px"))}),$("#offcanvas-menu").css("height",$(window).height()),$("#offcanvas-menu").css("right","-240px"),$(window).resize(()=>{const e=$(window);$("#offcanvas-menu").css("height",e.height()),e.width()>769&&$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))})})(),$(document).click(e=>{const t=$("#offcanvas-menu,.js-kratos-nav-toggle");t.is(e.target)||0!==t.has(e.target).length||$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))}),e(),$(document).on("click",".share",()=>{$(".share-wrap").fadeToggle("slow")}),a()}),window.onload=void console.log("页面加载完毕！消耗了 %c"+Math.round(100*performance.now())/100+" ms","background:#282c34;color:#51aded;")})();