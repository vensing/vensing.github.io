<div id="disqus_thread">
        <% if (!has_config('comment.shortname')) { %>
        <div class="notification is-danger">
            You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.
        </div>
        <% } %>
        <p class="disqus-notice hentry" style="text-align: center;">
            <i class="fa fa-spinner fa-spin" aria-hidden="true"></i>  如果 disqus 评论框加载不出来，你看着办吧！
        </p>
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
<% if (has_config('comment.shortname')) { %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2/dist/disqusjs.css">
<script src="https://cdn.jsdelivr.net/npm/disqusjs@1.1/dist/disqus.js"></script>
<script>
    function loadComments() {
        window.dsqjs = new DisqusJS({
            shortname: '<%= get_config('comment.shortname') %>',
            siteName: 'Vexsy BLOG',
            identifier: '',
            url: '',
            title: '',
            api: 'fNAJ3HUi2ocq4ImYPXnrAh0Q55w8T6fBXG7ka4NQkRJ40Oa1GcrIkhiFBKaH6Ews',
            apikey: 'bOXtpQHaIHfxsR4VGqOUNxojF6FGpwKEst7Cj3Pxo5IEAKrriBmIoxp3eegUxSqp',
            admin: 'Vexsy',
            adminLabel: '博主'
        });
    }
    
    // Lazy laod {# Credit: https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/comments/disqus.swig #}
    (function() {
        var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
        if (offsetTop <= 0) {
        // Load directly when there's no scrollbar
        window.addEventListener('load', loadComments, false);
        } else {
        var disqusScroll = function () {
            // offsetTop may changes because of manually resizing browser window or lazy loading images
            var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
            var scrollTop = window.scrollY;

            // Pre-load comments a bit? (margin or anything else)
            if (offsetTop - scrollTop < 60) {
            window.removeEventListener('scroll', disqusScroll);
            loadComments();
            }
        };
        window.addEventListener('scroll', disqusScroll);
        }
    })();
    
</script>
<% } %>
