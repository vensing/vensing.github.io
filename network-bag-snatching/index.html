<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/favicon.ico">
  <title>网络抓包那些事 | 芝士部落格</title>
  <meta name="author" content="Cheese" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="抓包, 接口" />
  
  <meta name="description" content="最近摸了几天鱼，给博客加了两个菜单页，ONE 每日一图和电影日历。这篇文章我想讲一下如何快乐的摸鱼🐟~">
<meta property="og:type" content="article">
<meta property="og:title" content="网络抓包那些事">
<meta property="og:url" content="https://chee5e.space/network-bag-snatching/index.html">
<meta property="og:site_name" content="芝士部落格">
<meta property="og:description" content="最近摸了几天鱼，给博客加了两个菜单页，ONE 每日一图和电影日历。这篇文章我想讲一下如何快乐的摸鱼🐟~">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://chee5e.space/images/favicon.ico">
<meta property="article:published_time" content="2020-06-21T09:46:00.000Z">
<meta property="article:modified_time" content="2020-12-05T12:07:15.000Z">
<meta property="article:author" content="Cheese">
<meta property="article:tag" content="抓包">
<meta property="article:tag" content="接口">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chee5e.space/images/favicon.ico">
<meta name="twitter:site" content="@youmuhoshi">
  <link rel="alternate" href="atom.xml" type="application/atom+xml">
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" type="text/css" media="all">
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight.min.css" type="text/css" media="all">
  
  
  <link rel="stylesheet" id="fontawe-css" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css" media="all">
  <link rel="stylesheet" id="nprogress-css" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" type="text/css" media="all">
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.6/dist/disqusjs.css">
  
  
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-dark.min.css" type="text/css" media="all">
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/qrcode_js@1.0.0/qrcode.min.js"></script>
  
<meta name="generator" content="Hexo 5.1.1"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <div class="nav-toggle"><a class="kratos-nav-toggle js-kratos-nav-toggle"><i></i></a></div>
            <header id="kratos-header-section">
                <div class="container">
                    <div class="nav-header">
                        <div class="color-logo"><a href="/">芝士部落格</a></div>
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                                    
                                
                                    
                                        <li><a href="/archives/"><i class="fa fa-archive"></i>档案馆</a></li>
                                    
                                
                                    
                                        <li><a href="/friends/"><i class="fa fa-mars-double"></i>朋友们</a></li>
                                    
                                
                                    
                                        <li><a href="/about/"><i class="fa fa-rocket"></i>关于我</a></li>
                                    
                                
                                    
                                        <li><a href="/one/"><i class="fa fa-podcast"></i>ONE 图文</a></li>
                                    
                                
                                    
                                        <li><a href="/movie/"><i class="fa fa-film"></i>电影日历</a></li>
                                    
                                
                                    
                                        <li>
                                            <a><i class="fa fa-flask"></i>实验室</a>
                                            <ul class="sub-menu">
                                                
                                                    
                                                
                                            </ul>
                                        </li>
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>芝士部落格</h2> <br />
                        <span>有思想，也有忧伤和理想，芝士就是力量</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div class="row">
                    
        <div id="main">
            <section class="col-md-8">
    <article>
        <div class="kratos-hentry kratos-post-inner clearfix">
            <header class="kratos-entry-header">
                <h1 class="kratos-entry-title text-center">网络抓包那些事</h1>
                
                <div class="kratos-post-meta text-center">
                    <span>
                        <i class="fa fa-calendar"></i> 2020-06-21
                        <i class="fa fa-folder"></i> 分类 <a class="label-link" href="/categories/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/">博客开发</a>
                        <i class="fa fa-user"></i> 作者 Cheese
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~4.09K
                        
                        字
                        
                    </span>
                </div>
            </header>
            <div class="kratos-post-content">
                <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                    本文最后修订于 <time datetime="1607170035000"></time>前 (2020-12-05)，其中的信息可能已经有所发展或者不再适用于现阶段。
                </div>
                
                    <div class="kratos-post-inner-toc">
                        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9F%E6%9B%BE%E5%90%91%E5%BE%80%E6%96%87%E8%89%BA%E7%9A%84%E9%9D%92%E5%B9%B4"><span class="toc-number">1.</span> <span class="toc-text">也曾向往文艺的青年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ONE-%E6%AF%8F%E6%97%A5%E5%9B%BE%E6%96%87%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.</span> <span class="toc-text">ONE 每日图文接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%8A%93%E5%8F%96%E6%8E%A5%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="toc-number">2.1.</span> <span class="toc-text">控制台抓取接口地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CloudFlare-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%8E%A5%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.</span> <span class="toc-text">CloudFlare 反向代理接口地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86"><span class="toc-number">3.</span> <span class="toc-text">豆瓣电影日历</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IOS-%E4%B8%8A%E4%BD%BF%E7%94%A8%E6%8A%93%E5%8C%85%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">IOS 上使用抓包软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%93%E5%8F%96%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.</span> <span class="toc-text">抓取电影日历接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.3.</span> <span class="toc-text">反向代理电影日历接口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">4.</span> <span class="toc-text">最后</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%9F%E8%B0%A2"><span class="toc-number">6.</span> <span class="toc-text">感谢</span></a></li></ol>
                    </div>
                
                <!-- <hr /> -->
                <p>最近摸了几天鱼，给博客加了两个菜单页，ONE 每日一图和电影日历。这篇文章我想讲一下如何快乐的摸鱼🐟~</p>
<a id="more"></a>

<h3 id="也曾向往文艺的青年"><a href="#也曾向往文艺的青年" class="headerlink" title="也曾向往文艺的青年"></a>也曾向往文艺的青年</h3><p>摸鱼之前先来回忆下以前的事情。说起来，我在高中的时候就开始在 QQ 空间上写日志，最开始是看别人写日志，后面觉得光看别人写不过瘾，也就开始了自己写。当然，内容完全没有什么立意也没有主题和深度，当初竟然还能不嫌丢脸光明正大的发出来，以至于我现在将这些日志全部设置为仅个人可以查看。</p>
<p>随着岁月的无情摧残，我也已经从学校里的学生成长为不务正业的社畜摸鱼怪了。写日志的习惯倒是延续到了写博客文章，不过我已经不是那个向往文艺的青年了，我开始变得世俗起来，这又是另一回事了，有时间的话我还真想写写我自己。岁月无情的将一个曾经向往文艺的青年，变成了一个可悲可叹的摸鱼怪。</p>
<p>好了，回忆就先到这了。既然是向往文艺的青年，那肯定会接触一些文艺生活的信息啦。这里我想介绍下的是「ONE·一个」：</p>
<blockquote>
<p>App「一个」<br>每天只为你准备一张图片、一篇文字和一个问答<br>韩寒主编和监制 原《独唱团》主创成员共同制作<br>复杂世界里, 一个就够了. One is all.</p>
</blockquote>
<p>这是官网介绍的 slogan，看得出来确实是有文艺的人会下载的 APP。一个 APP 里，每天都会推送一张图片和一段图文的「每日图文」，有点像一言的感觉。我倒是蛮喜欢这种每日图文的方式，有时候这么一张图和一段文字会让我们从浮躁的生活中脱离出来看到生活其实还有诗和远方，然后再重新融入滚滚红尘。所以，我就想把 ONE 每日图文加到博客里，既方便自己阅读也能让更多的人看到。</p>
<h3 id="ONE-每日图文接口"><a href="#ONE-每日图文接口" class="headerlink" title="ONE 每日图文接口"></a>ONE 每日图文接口</h3><p>理由就是这么个理由，所以如何把每日图文的信息给抓到呢？</p>
<p>大概有这么几种方式：</p>
<ul>
<li>写个爬虫，每天爬  ONE 的每日图文； </li>
<li>谷歌一下，看看电脑网页端有没有暴露 API；</li>
<li>抓一下移动 APP 上的包，找出接口。</li>
</ul>
<p>由于，我用的是 Hexo 静态博客，没有服务端而我又不愿意花钱买服务器，就为了这么一个小功能就写爬虫太不轻量了，所以爬虫就砍掉吧 (其实是我不会写爬虫ww。</p>
<h4 id="控制台抓取接口地址"><a href="#控制台抓取接口地址" class="headerlink" title="控制台抓取接口地址"></a>控制台抓取接口地址</h4><p>作为程序员，当然得学会面向搜索引擎编程了，也很快就找到了ONE 网页端暴露的 API 接口。在 ONE 官网移动端就暴露了这么一个每日图文的接口：</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/M9pUbR2zVx4q63I.png" alt="每日图文的接口"></p>
<p>调试当然得打开控制台啦，Chrome 也为我们提供了模拟移动设备的环境，点击控制台左上角的【device toolbar】图标就可以切换模拟移动设备访问网页了。很幸运，我们很快就找到了每日图文的网址 API，这是一个 XHR ajax 请求，带了一个<code>_token</code> 参数。在控制台中，找到该请求的 <code>Initiator</code> 栏查看 Request call stack。最后我们会找到该请求的发起位置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">One.token = <span class="string">&#x27;b15449f4a9c6a23f9e21ac1339c4b8e0b73767be&#x27;</span>;</span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> page = $(<span class="string">&#x27;#myPage_angOne_index&#x27;</span>);</span><br><span class="line">    One.listPage.init(page, <span class="string">&#x27;http://m.wufazhuce.com/one/ajaxlist/&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这个 <code>_token</code> 是随着 <a target="_blank" rel="noopener" href="http://m.wufazhuce.com/one">http://m.wufazhuce.com/one</a> HTML 页面返回的；在第一次访问这个页面时，有一个 <code>Set-Cookie</code> 返回头，我们的 ajaxlist 请求的请求头需带上 <code>Cookie</code>，值就是刚才的<code>Set-Cookie</code> 返回的值，然后我们还得带上查询参数 <code>_token</code>。</p>
<p>我们可以在 <code>postman</code> 上测试下设置 <code>_token</code> 和 <code>Cookie</code> 后是否能正确访问到 API：</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/2ZWTwJmerUnBkYp.png" alt="one_postman.png"></p>
<p>可以看到我们已经能通过接口拿到一组数据了，当天的数据 (最新一条数据) 位于数组索引 0 的位置。</p>
<h4 id="CloudFlare-反向代理接口地址"><a href="#CloudFlare-反向代理接口地址" class="headerlink" title="CloudFlare 反向代理接口地址"></a>CloudFlare 反向代理接口地址</h4><p>但是，我们还不能直接在我们的网站中发起 Ajax 异步请求调用这个 API，因为存在跨域问题。跨域问题我们可以使用 CloudFlare 的免费 Workers 功能反向代理 ONE 的 API 接口，同时设置下跨域请求头。设置反向代理时，需要发起两个请求，第一个请求的地址是 <a target="_blank" rel="noopener" href="http://m.wufazhuce.com/one">http://m.wufazhuce.com/one</a> 页面，我们需要拿到第一次访问页面时，响应头的 <code>Set-Cookie</code> 返回值和 HTML 页面脚本中的 <code>_token</code> 值。第二个请求的地址是 <a target="_blank" rel="noopener" href="http://m.wufazhuce.com/one/ajaxlist/">http://m.wufazhuce.com/one/ajaxlist/</a> ，设置请求头 <code>Cookie</code> 的值为刚刚拿到的<code>Set-Cookie</code> 返回值，以及带上 <code>_token</code> 查询参数。</p>
<p>这样的一通操作下来，我们就能在我们的网站中拿到 ONE 每日图文的数据了。具体的代码参见：<a target="_blank" rel="noopener" href="https://github.com/vensing/OneToday/blob/master/OneTodayWorker.js">OneTodayWorker.js</a> 借鉴和参考了 disqusjs 官方提供的 CF 反代示例， ONE 每日图文使用方法查看 <a target="_blank" rel="noopener" href="https://github.com/vensing/OneToday">OneToday</a> 仓库的 README 文件。</p>
<p>由于，第二种方式就能实现我所需的功能，所以移动设备抓包获取接口地址就没考虑了ww。</p>
<h3 id="豆瓣电影日历"><a href="#豆瓣电影日历" class="headerlink" title="豆瓣电影日历"></a>豆瓣电影日历</h3><p>说起来，豆瓣也经历过 14 个年头的站点了，而豆瓣也好像一直没有令人印象深刻的 slogan ，倒是豆瓣电影和书影音档案成为了相关内容的百科全书。豆瓣大约在 2017 年推出了 <a target="_blank" rel="noopener" href="https://book.douban.com/subject/34775984/">『豆瓣电影日历』</a> 纸质日历，每天推荐一部高分电影，并且在 IOS 的 Today Widget 上有电子版『豆瓣电影日历』和纸质日历同步，这个功能很多人并不知道。</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/GtdAbWJIpnmBlYQ.jpg" alt="豆瓣电影日历"></p>
<p>豆瓣电影日历和 ONE 每日图文的展示形式类似，以一张图一段文字每天推荐一部高分电影。那么能不能像 ONE 每日图文那样抓取接口地址呢？</p>
<h4 id="IOS-上使用抓包软件"><a href="#IOS-上使用抓包软件" class="headerlink" title="IOS 上使用抓包软件"></a>IOS 上使用抓包软件</h4><p>经过一番折腾，我排除了网页端暴露 API 接口的方式，爬虫也没有办法，因为只有在 IOS 上才有豆瓣电影日历。所以，问题就来到了如何在 IOS 上抓包的问题。IOS 上有很多款抓包软件，其中比较出名的两款是：</p>
<ul>
<li>Stream，免费，功能也完善</li>
<li>Thor，付费且功能完善</li>
</ul>
<p>这两款软件的安装步骤都基本一致：</p>
<ol>
<li>安装证书：设置 &gt; 通用 &gt; 描述文件 &gt; 进入描述文件详情 &gt; 安装</li>
<li>信任证书：设置 &gt; 关于本机 &gt; 证书信任设置</li>
</ol>
<p><strong>注意：</strong> 请做好第二步，信任证书，否则使用 Stream 抓取走 https 协议的站点时，会报kCFStreamErrorDomainSSL 错误，Thor 也一样要信任证书。我就是在这边被坑了一阵子 (</p>
<p>抓包软件的原理如下：</p>
<blockquote>
<p><strong>HTTPS 解析原理</strong><br>Thor 实现的 HTTPS 解析方式是 MiTM （中间人欺骗）：需要用 Thor SSL CA 根证书针对特定域名生成叶子证书，用此叶子证书跟客户端（请求发起方）通信，并成功解析流量。<br>客户端（请求发起方）如果做了证书本地验证（即验证跟它通信的叶子证书是否是它原来商定好的证书），那么 Thor 生成的叶子证书跟客户端之间的 SSL 连接将会失败，自然就也解不了这类流量。<br>总之 HTTPS MiTM 不是万能的，望知晓。</p>
</blockquote>
<p>所以，Thor 和 Stream 都需要设置开启系统 VPN 代理功能，才能进行抓包，这就意味着你无法在手机上一边开启VPN 科学上网一边使用 Thor 或 Stream  来进行抓包。Thor 并非万能，只工作在系统 HTTP 层: 不支持非 HTTP 流量(TCP, UDP)及不经过系统 HTTP 代理的流量。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PixelCyber/Thor/blob/master/README-zh-Hans.md">点此查看 Thor 使用帮助</a>，特别感谢 <a target="_blank" rel="noopener" href="https://blog.badapple.pro/">东方幻梦</a> 同学给我 Apple ID 白嫖 Thor。</p>
<h4 id="抓取电影日历接口"><a href="#抓取电影日历接口" class="headerlink" title="抓取电影日历接口"></a>抓取电影日历接口</h4><p>抓包这个操作，其实很简单，先把其他软件从后台切出防止不必要的网络请求。然后，进入软件首页点击按钮开启抓包，iPhone 切到 Today Widget 小组件页面(需先开启豆瓣每日电影 Widget )即可，返回抓包软件，即可看到抓到的请求。</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/Qfmv3nykSt6xVHs.jpg" alt="抓包结果——请求头"></p>
<p>最重要的是请求头和请求行，我们可以在 <code>Postman</code> 上，输入上述请求头及请求地址和查询参数：</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/dgLZTvyn47QzGCe.png" alt="Postman测试接口成功"></p>
<p>请求头，按抓取的请求头设置即可，查询参数中我们只需要替换 <code>date</code> 参数即可；<code>_ts</code> 是时间戳和 <code>_sig</code> 签名应该是对应关系所以可以不用管。返回头中 Cookie 的过期时间貌似设置的是不过期，最理想的情况是我们使用抓取到的请求头和查询参数配置我们自己的请求即可，需要替换的只是 <code>date</code> 日期。而 Cookie 和 签名这些是否会随着时间改变这些也无从验证(按道理是不会变的)，没办法别人的接口又没公开，只能这么干啦。</p>
<h4 id="反向代理电影日历接口"><a href="#反向代理电影日历接口" class="headerlink" title="反向代理电影日历接口"></a>反向代理电影日历接口</h4><p>和 ONE 每日图文一样，我们还不能直接在我们的网站中发起 Ajax 异步请求调用这个 API，因为存在跨域问题。这里同样可以使用 CloudFlare 的免费  Workers 功能反向代理 API 接口，同时设置下跨域请求头和查询参数。</p>
<p>关于代理的配置，比  ONE 每日图文的配置还要简单，因为电影日历可能会涉及到版权问题，所以这里的反向代理代码就不公开了。因为豆瓣的公共 API 都下线了，所以现在都需要加上 apikey，个人使用应该也没啥大碍。</p>
<p>还有一个接口返回的图片 url 在博客网站上出现 403 防盗链的问题，这里我使用了 <a target="_blank" rel="noopener" href="https://images.weserv.nl/?url=">https://images.weserv.nl/?url=</a> 提供的服务进行反代解决。</p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>可以在本站导航栏上的 <code>One 图文</code> 和 <code>电影日历</code> 菜单项查看，放下效果图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/AE1HZaONsXVyrf6.png" alt="ONE 每日图文"></p>
<p><img src="https://cdn.jsdelivr.net/gh/vensing/static@master/image/3PXlrJeR7j9oZnd.png" alt="豆瓣电影日历"></p>
<p>这两个接口都只在个人博客使用，方便查阅每日更新，不用于商业或者其他用途。如有侵权，请联系我删除。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e9617107b748">图文 - 「ONE · 一个」 官方API分析</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/idawnlight/disqusjs-proxy-cloudflare-workers/blob/master/worker.js">disqusjs CF Workers  反代示例</a></li>
</ul>
<h3 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h3><p>感谢 <a href="cloudflare.com">cloudflare.com</a> 提供的免费 Worker 服务。</p>

            </div>
            
                <div class="kratos-copyright text-center clearfix">
                    <h5>本作品采用 <a rel="license nofollow" target="_blank" href="http://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
                </div>
            
            <footer class="kratos-entry-footer clearfix">
                
                    <div class="post-like-donate text-center clearfix" id="post-like-donate">
                    
                    
                        <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                        <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "https://chee5e.space/network-bag-snatching/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "https://chee5e.space/network-bag-snatching/";
            const title         = "「网络抓包那些事」";
            const excerpt       = `最近摸了几天鱼，给博客加了两个菜单页，ONE 每日一图和电影日历。这篇文章我想讲一下如何快乐的摸鱼🐟~`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                    
                    </div>
                
                <div class="footer-tag clearfix">
                    <div class="pull-left">
                    <i class="fa fa-tags"></i>
                        <a class="tag-none-link" href="/tags/%E6%8A%93%E5%8C%85/" rel="tag">抓包</a>, <a class="tag-none-link" href="/tags/%E6%8E%A5%E5%8F%A3/" rel="tag">接口</a>
                    </div>
                    <div class="pull-date">
                    <span>最后编辑：2020-12-05</span>
                    </div>
                </div>
            </footer>
        </div>
        
            <nav class="navigation post-navigation clearfix" role="navigation">
                
                <div class="nav-previous clearfix">
                    <a title=" 永远的MAYDAY，永远的五月天" href="/may_day/">&lt; 上一篇</a>
                </div>
                
                
                <div class="nav-next clearfix">
                    <a title=" 搭建一个自己的 Gitlab CI Runner" href="/gitlab-runner-in-docker/">下一篇 &gt;</a>
                </div>
                
            </nav>
        
        
            <div id="disqus_thread" class="post-comments lazy-load"></div>
<script>
    var load_comm = () => {
        const init = () => {
            window.DISQUS = null;
            new DisqusJS({
                shortname: 'vensing-com',
                siteName: 'vensing',
                identifier: 'network-bag-snatching/',
                url: 'https://chee5e.space/network-bag-snatching/',
                api: 'https://disqusjs-api.vensing.workers.dev/api/',
                apikey: 'bOXtpQHaIHfxsR4VGqOUNxojF6FGpwKEst7Cj3Pxo5IEAKrriBmIoxp3eegUxSqp',
                admin: 'Cheese',
                adminLabel: '芝士'
            });
        }
        if (typeof DisqusJS == 'undefined') {
            const src = 'https://cdn.jsdelivr.net/npm/disqusjs@1.3.0/dist/disqus.js';
            $.getScript(src, init);
        } else {
            init();
        }
    };
</script>
<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://github.com/SukkaW/DisqusJS">comments powered by DisqusJS.</a></noscript>
        
    </article>
</section>
        </div>
                
            <section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
                
                    <aside id="krw-about" class="widget widget-kratos-about clearfix">
    
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.jpg" />
        </div>
    </div>
    <div class="textwidget">
        
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9F%E6%9B%BE%E5%90%91%E5%BE%80%E6%96%87%E8%89%BA%E7%9A%84%E9%9D%92%E5%B9%B4"><span class="toc-number">1.</span> <span class="toc-text">也曾向往文艺的青年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ONE-%E6%AF%8F%E6%97%A5%E5%9B%BE%E6%96%87%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.</span> <span class="toc-text">ONE 每日图文接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%8A%93%E5%8F%96%E6%8E%A5%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="toc-number">2.1.</span> <span class="toc-text">控制台抓取接口地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CloudFlare-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%8E%A5%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.</span> <span class="toc-text">CloudFlare 反向代理接口地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86"><span class="toc-number">3.</span> <span class="toc-text">豆瓣电影日历</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IOS-%E4%B8%8A%E4%BD%BF%E7%94%A8%E6%8A%93%E5%8C%85%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">IOS 上使用抓包软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%93%E5%8F%96%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.</span> <span class="toc-text">抓取电影日历接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%94%B5%E5%BD%B1%E6%97%A5%E5%8E%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.3.</span> <span class="toc-text">反向代理电影日历接口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">4.</span> <span class="toc-text">最后</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%9F%E8%B0%A2"><span class="toc-number">6.</span> <span class="toc-text">感谢</span></a></li></ol>
        
    </div>
</aside>
                
                    <!-- Moved to about.ejs -->
                
                    
  <aside id="krw-categories" class="widget widget-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%87%E5%8F%B6%E9%9B%86/">万叶集</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8A%A8%E6%BC%AB%E8%BF%B7/">动漫迷</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/">博客开发</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2%E8%AE%B0%E5%BD%95/">博客记录</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/">年终总结</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8F%BD%E4%BB%B6%E6%97%A5%E5%BF%97/">揽件日志</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%88%B1%E9%9F%B3%E4%B9%90/">爱音乐</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/">瞎折腾</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/">碎碎念</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E6%9C%AD%E8%AE%B0/">编程札记</a><span class="category-list-count">2</span></li></ul>
  </aside>


                
                    
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/2/" style="font-size: 0.6em;">2</a> <a href="/tags/2020/" style="font-size: 0.6em;">2020</a> <a href="/tags/CI/" style="font-size: 0.8em;">CI</a> <a href="/tags/Kratos/" style="font-size: 0.6em;">Kratos</a> <a href="/tags/Travis-CI/" style="font-size: 0.8em;">Travis CI</a> <a href="/tags/Vue/" style="font-size: 0.6em;">Vue</a> <a href="/tags/WSL/" style="font-size: 0.6em;">WSL</a> <a href="/tags/Win10/" style="font-size: 0.6em;">Win10</a> <a href="/tags/docker/" style="font-size: 0.6em;">docker</a> <a href="/tags/fancybox/" style="font-size: 0.6em;">fancybox</a> <a href="/tags/gzip/" style="font-size: 0.6em;">gzip</a> <a href="/tags/hexo/" style="font-size: 0.6em;">hexo</a> <a href="/tags/nodejs/" style="font-size: 0.6em;">nodejs</a> <a href="/tags/pjax/" style="font-size: 0.6em;">pjax</a> <a href="/tags/racket/" style="font-size: 0.6em;">racket</a> <a href="/tags/saint-seiya/" style="font-size: 0.6em;">saint seiya</a> <a href="/tags/sicp/" style="font-size: 0.6em;">sicp</a> <a href="/tags/switch/" style="font-size: 0.6em;">switch</a>
      </div>
  </aside>

                
                    
  <aside id="krw-posts" class="widget widget-kratos-poststab">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/sicp-vscode-setup/"><i class="fa  fa-book"></i> VS Code 搭建 SICP 环境</a>
            
          
        
          
          
            <a class="list-group-item" href="/recent-insights/"><i class="fa  fa-book"></i> 近期的一些想法</a>
            
          
        
          
          
            <a class="list-group-item" href="/switch-pickup-log/"><i class="fa  fa-book"></i> Switch 海外购日志</a>
            
          
        
          
          
            <a class="list-group-item" href="/my-little-fish-wake-up/"><i class="fa  fa-book"></i> 我的小鱼你醒了</a>
            
          
        
          
          
            <a class="list-group-item" href="/adachi-and-shimamura/"><i class="fa  fa-book"></i> 安達としまむら</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

                
            </section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer">
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://t.me/chee5e"><i class="fa fa-telegram"></i></a></li>
                        <li><a target="_blank" rel="nofollow" href="https://twitter.com/youmuhoshi"><i class="fa fa-twitter"></i></a></li>
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/vensing"><i class="fa fa-github"></i></a></li>
                        <li><a target="_blank" rel="nofollow" href="/atom.xml"><i class="fa fa-rss"></i></a></li>
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2021 Cheese 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Made with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by <a href="https://candinya.com" target="_blank" rel="nofollow">Candinya</a>.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>
<script>const notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));</script>

<script async src="/js/candy.min.js"></script>


    <script defer src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>


    <script defer src="/js/kr-dark.min.js"></script>


    </body>
</html>